# 中药学习助手 (Traditional Chinese Medicine Learning App)

一个用于学习中药知识的 Android 应用程序，基于 Jetpack Compose 构建。

## 功能特点

- **中药数据库**：包含常见中药的详细信息，如性味归经、功效、主治等
- **分类浏览**：根据中药分类（补气类、补血类、清热类等）浏览中药
- **详细介绍**：查看每种中药的详细信息和用法用量
- **学习课程**：提供中药学习课程，包括基础知识、配伍原则等
- **知识测验**：通过测验检验学习成果
- **个人中心**：记录学习进度和测验成绩

## 技术栈

- **Kotlin**：主要开发语言
- **Jetpack Compose**：现代化 UI 开发工具包
- **Navigation Compose**：处理应用内导航
- **Material Design**：遵循 Material Design 设计规范

## 项目结构

```
app/
├── src/
│   ├── main/
│   │   ├── java/com/tcm/traditionalchinesemedician/
│   │   │   ├── data/            # 数据模型和存储库
│   │   │   ├── ui/              # UI 组件
│   │   │   │   ├── screens/     # 各个屏幕
│   │   │   │   └── theme/       # 主题和样式
│   │   │   └── MainActivity.kt  # 主活动
│   │   └── res/                 # 资源文件
│   │       ├── values/          # 字符串、颜色、主题等
│   │       └── ...
│   └── ...
└── ...
```

## 安装要求

- Android 7.0 (API 级别 24) 或更高版本
- 大约 50MB 的存储空间

## 如何运行

1. 克隆本仓库
2. 在 Android Studio 中打开项目
3. 构建并运行应用程序

## 后续计划

- [ ] 添加更多中药数据
- [ ] 实现用户账户系统
- [ ] 添加中药配伍功能
- [ ] 添加中药图片库
- [ ] 实现离线数据存储
- [ ] 支持多语言（中英文）

## 贡献

欢迎提交 Pull Request 或创建 Issue 来帮助改进这个项目。

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

# 中药数据本地存储实现

## 概述

为了优化应用性能和支持更大数据量，我们对中药数据的存储和获取机制进行了重构，使用 Room 数据库来保存和管理中药数据。主要实现了以下功能：

1. 使用 Room 数据库存储中药数据
2. 实现数据版本控制和自动更新
3. 添加分页加载功能，优化大数据量查询
4. 保持与现有代码的兼容性

## 数据库结构

### 实体类

- **HerbEntity**: 中药数据实体类，对应数据库表
- **VersionEntity**: 版本信息实体类，用于跟踪数据版本

### 数据访问对象 (DAO)

- **HerbDao**: 提供中药数据的增删改查操作
- **VersionDao**: 提供版本信息的查询和更新操作

## 数据同步机制

应用启动时，会执行以下步骤来确保数据的一致性和更新：

1. 从 `assets/herbs.json` 文件中读取版本号
2. 检查数据库中存储的当前版本号
3. 如果 JSON 文件版本号大于数据库版本号，执行数据更新：
   - 清除数据库中的旧数据
   - 将 JSON 文件中的数据导入数据库
   - 更新数据库版本号

## 分页加载

为了处理大量中药数据，我们实现了分页加载功能：

- 每页加载固定数量的数据（默认 20 条）
- 滚动到列表底部时自动加载下一页
- 支持按分类和搜索条件进行分页查询

## 集成到应用中

所有与中药相关的数据获取操作都已调整为使用 Room 数据库：

- **搜索功能**：通过数据库 LIKE 查询实现
- **分类筛选**：通过数据库条件查询实现
- **详情页加载**：通过 ID 精确查询实现
- **每日推荐**：从数据库中随机选择并缓存推荐项

## JSON 格式更新

`herbs.json` 文件格式已更新，添加了版本信息：

```json
{
  "version": 1,
  "herbs": [
    // 药材数据...
  ]
}
```

## 未来扩展

1. 实现网络数据同步功能，从远程服务器下载最新药材数据
2. 添加用户自定义数据，如收藏、笔记等功能
3. 实现更复杂的搜索功能，如模糊匹配、组合条件等 